!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("GeopackageManager",[],t):"object"==typeof exports?exports.GeopackageManager=t():e.GeopackageManager=t()}(window,function(){return function(e){function t(t){for(var n,u,o=t[0],i=t[1],s=t[2],c=0,f=[];c<o.length;c++)u=o[c],r[u]&&f.push(r[u][0]),r[u]=0;for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n]);for(d&&d(t);f.length;)f.shift()();return l.push.apply(l,s||[]),a()}function a(){for(var e,t=0;t<l.length;t++){for(var a=l[t],n=!0,o=1;o<a.length;o++){var i=a[o];0!==r[i]&&(n=!1)}n&&(l.splice(t--,1),e=u(u.s=a[0]))}return e}var n={},r={1:0},l=[];function u(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,u),a.l=!0,a.exports}u.m=e,u.c=n,u.d=function(e,t,a){u.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},u.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.t=function(e,t){if(1&t&&(e=u(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(u.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)u.d(a,n,function(t){return e[t]}.bind(null,n));return a},u.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return u.d(t,"a",t),t},u.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},u.p="/static/cartoview_basic_viewer/dist/";var o=window.webpackJsonp_name_=window.webpackJsonp_name_||[],i=o.push.bind(o);o.push=t,o=o.slice();for(var s=0;s<o.length;s++)t(o[s]);var d=i;return l.push(["7xdy",0]),a()}({"7cd4":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=v(a("Yz+Y")),r=v(a("iCc5")),l=v(a("V7oC")),u=v(a("FYw3")),o=v(a("mRg0")),i=v(a("1OZW")),s=v(a("DKSo")),d=v(a("0G56")),c=v(a("Sk/v")),f=v(a("SNP2")),p=v(a("/xgX")),m=v(a("C+zi")),h=v(a("17x9")),g=v(a("q1tI")),y=v(a("ZqOF")),E=v(a("6ZaM")),b=a("SUMQ");function v(e){return e&&e.__esModule?e:{default:e}}var _=function(e){function t(){return(0,r.default)(this,t),(0,u.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,o.default)(t,e),(0,l.default)(t,[{key:"render",value:function(){var e=this.props,t=e.publishLayer,a=e.publishModalOpen,n=e.handlPublishModal,r=e.publishLoading,l=e.classes,u=e.publishName,o=e.handlePublishName,h=e.publishError;return g.default.createElement(d.default,{disableBackdropClick:!0,open:a,onClose:n,"aria-labelledby":"form-dialog-title"},g.default.createElement(m.default,{id:"form-dialog-title"},"Publish Layer"),g.default.createElement(f.default,null,g.default.createElement(p.default,null,h&&g.default.createElement(E.default,{className:l.flexGrow,noWrap:!0,color:"secondary",variant:"subheading"},h),"Please Enter Name You Want to publish Layer With."),g.default.createElement(y.default,{inputProps:{maxLength:63},autoFocus:!0,value:u,onChange:o,margin:"dense",id:"name",label:"Publish Name",fullWidth:!0,required:!0})),g.default.createElement(c.default,null,r&&g.default.createElement(s.default,{className:l.progress,thickness:7}),g.default.createElement(i.default,{disabled:r,onClick:n,color:"primary"},"Cancel"),g.default.createElement(i.default,{disabled:r,onClick:t,color:"primary"},"Publish")))}}]),t}(g.default.Component);_.propTypes={classes:h.default.object.isRequired,publishLayer:h.default.func.isRequired,handlPublishModal:h.default.func.isRequired,handlePublishName:h.default.func.isRequired,publishModalOpen:h.default.bool.isRequired,publishLoading:h.default.bool.isRequired,publishName:h.default.string,publishError:h.default.string},t.default=(0,b.withStyles)(function(e){return{flexGrow:{flexGrow:1},progress:{margin:2*e.spacing.unit}}})(_)},"7xdy":function(e,t,a){"use strict";(function(e){var t=N(a("Yz+Y")),n=N(a("iCc5")),r=N(a("V7oC")),l=N(a("FYw3")),u=N(a("mRg0")),o=N(a("YEIV")),i=N(a("QbLZ"));a("bZMm"),a("201c"),a("RQfP");var s=a("q1tI"),d=N(s),c=a("tF6y"),f=a("9Em9"),p=a("vu7d"),m=N(a("uctU")),h=N(a("yzbm")),g=N(a("DrhM")),y=N(a("vrOF")),E=N(a("Nlzp")),b=N(a("1IiC")),v=N(a("JgXy")),_=N(a("WqRt")),L=a("SUMQ"),S=N(a("pPbJ")),O=N(a("17x9")),P=a("/MKj"),M=N(a("6ZaM")),x=N(a("ixGs")),R=N(a("TSYQ")),w=a("i8i4"),T=a("Q2AE"),k=a("AiFK");function N(e){return e&&e.__esModule?e:{default:e}}var U=function(e){function a(e){(0,n.default)(this,a);var r=(0,l.default)(this,(a.__proto__||(0,t.default)(a)).call(this,e));r.onDrop=function(e){r.setState({files:e})},r.removeUploadedFile=function(e){var t=r.state.files.filter(function(t){return t!==e});r.setState({files:t})};var u=r.props,o=u.token,i=u.username,s=u.urls;return r.state={files:[]},r.geopackageApi=new E.default(i,o,s),r.requests=new p.ApiRequests(i,r.token),r}return(0,u.default)(a,e),(0,r.default)(a,[{key:"componentDidMount",value:function(){var e=this.props,t=e.setUploads,a=e.setUploadsLoading,n=e.setTotalCount,r=e.setPermissions,l=e.setPermissionsLoading;this.geopackageApi.getUploads().then(function(e){t(e.objects),n(e.meta.total_count),a(!1)}),this.geopackageApi.getPermissions().then(function(e){r(e),l(!1)})}},{key:"render",value:function(){var e=this,t=this.props,a=t.classes,n=t.uploads,r=t.uploadsLoading,l=this.state.files;return d.default.createElement(L.MuiThemeProvider,{theme:k.theme},d.default.createElement("div",{className:a.fullHeight},d.default.createElement(m.default,{title:"GeoPackage Manager"}),d.default.createElement(S.default,{className:(0,R.default)([a.root])},d.default.createElement(S.default,{elevation:2},d.default.createElement(h.default,{className:a.dropZone,accept:".gpkg",onDrop:this.onDrop},d.default.createElement("label",{htmlFor:"icon-button-file"},d.default.createElement(b.default,{color:"default",className:a.button,component:"span"},d.default.createElement(y.default,null))),d.default.createElement(M.default,{variant:"display1",gutterBottom:!0},"Click to Choose Packages or Drop Packages Here to Upload"))),l.length>0&&d.default.createElement(S.default,{className:(0,R.default)([a.fullWidth],[a.uploadPaper]),elevation:2},d.default.createElement(v.default,{className:a.fullWidth,component:"nav",subheader:d.default.createElement(_.default,{component:"div"},"Uploading")},l.map(function(t,a){return d.default.createElement(g.default,{file:t,removeUploadedFile:e.removeUploadedFile,key:a})}))),n.length>0&&!r&&d.default.createElement(x.default,null))))}}]),a}(s.Component);U.propTypes={classes:O.default.object.isRequired,urls:O.default.object.isRequired,username:O.default.string.isRequired,token:O.default.string.isRequired,setUploads:O.default.func.isRequired,uploads:O.default.array.isRequired,uploadsLoading:O.default.bool.isRequired,setUploadsLoading:O.default.func.isRequired,setPermissionsLoading:O.default.func.isRequired,setPermissions:O.default.func.isRequired,setTotalCount:O.default.func.isRequired};var C=(0,P.connect)(function(e){return{username:e.username,token:e.token,urls:e.urls,uploads:e.uploads,uploadsLoading:e.uploadsLoading,permissions:e.permissions,permissionsLoading:e.permissionsLoading,uploadsTotalCount:e.uploadsTotalCount}},function(e){return{setUploadsLoading:function(t){return e((0,c.uploadsLoading)(t))},setUploads:function(t){return e((0,c.newUploads)(t))},setPermissionsLoading:function(t){return e((0,f.permissionsLoading)(t))},setPermissions:function(t){return e((0,f.permissions)(t))},setTotalCount:function(t){return e((0,c.uploadsTotalCount)(t))}}})((0,L.withStyles)(function(e){var t;return{fullHeight:{height:"100%"},fullWidth:{width:"100%"},uploadPaper:{marginTop:2*e.spacing.unit,marginBottom:2*e.spacing.unit},button:{margin:e.spacing.unit},dropZone:{width:"100%",padding:"1em",flexDirection:"column",display:"flex",alignItems:"center",justifyContent:"center",boxSizing:"border-box",textAlign:"center"},root:(0,i.default)((t={height:"calc( 100% - "+e.mixins.toolbar["@media (min-width:600px)"].minHeight+"px)"},(0,o.default)(t,e.breakpoints.down("sm"),{height:"calc( 100% - "+e.mixins.toolbar["@media (min-width:0px) and (orientation: landscape)"].minHeight+"px)"}),(0,o.default)(t,"boxSizing","border-box"),t),e.mixins.gutters(),{paddingTop:2*e.spacing.unit,paddingBottom:2*e.spacing.unit,overflowX:"scroll",zIndex:0,background:"#f3f3f3"})}})(U));e.GeopackageManagerRenderer={show:function(e,t){(0,w.render)(d.default.createElement(P.Provider,{store:(0,T.storeWithInitial)(t)},d.default.createElement(C,null)),document.getElementById(e))}}}).call(this,a("yLpj"))},"9Em9":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.permissions=function(e){return{type:n.SET_PERMISSIONS,payload:e}},t.updatePermissions=function(e,t,a){return{type:n.UPDATE_PERMISSIONS,payload:{keys:e,id:t,operation:a}}},t.permissionsLoading=function(e){return{type:n.PERMISSIONS_LOADING,payload:e}};var n=a("TUL1")},AiFK:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.theme=void 0;var n=o(a("vqLa")),r=a("SUMQ"),l=o(a("wokB")),u=o(a("fWIC"));function o(e){return e&&e.__esModule?e:{default:e}}t.theme=(0,r.createMuiTheme)({palette:{primary:n.default,secondary:u.default,error:l.default}})},DrhM:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=L(a("GQeE")),r=L(a("Yz+Y")),l=L(a("iCc5")),u=L(a("V7oC")),o=L(a("FYw3")),i=L(a("mRg0")),s=a("q1tI"),d=L(s),c=a("TUL1"),f=a("vu7d"),p=L(a("QGGi")),m=L(a("vrOF")),h=L(a("NABS")),g=L(a("4eE1")),y=L(a("17x9")),E=a("tF6y"),b=a("/MKj"),v=a("9Em9"),_=a("SUMQ");function L(e){return e&&e.__esModule?e:{default:e}}var S=function(e){function t(e){(0,l.default)(this,t);var a=(0,o.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e)),n=a.props,u=n.username,i=n.token;a.state={progress:0,error:null};var s=i.split(" for ")[0];return a.requests=new f.ApiRequests(u,s),a}return(0,i.default)(t,e),(0,u.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,a=t.urls,r=t.file,l=t.addUpload,u=t.updatePermissions,o=t.permissions,i=t.removeUploadedFile,s=new FormData;s.append("package",r),this.requests.uploadWithProgress(a.uploadsURL,s,function(e){},function(t){if(t.lengthComputable){var a=t.loaded/t.total*100;e.setState({progress:a})}},function(e){201===e.status&&setTimeout(function(){var t=JSON.parse(e.responseText);l(t),u((0,n.default)(o),t.id,c.ADD_PERMISSION_OP),i(r)},1e3)},function(t){t.status>=400&&e.setState({error:t.statusText})})}},{key:"render",value:function(){var e=this.state,t=e.progress,a=e.error,n=this.props.file;return d.default.createElement(h.default,null,d.default.createElement(p.default,null,d.default.createElement(m.default,null)),d.default.createElement(g.default,{primary:n.name,secondary:a||t+"% Complete"}))}}]),t}(s.Component);S.propTypes={file:y.default.object.isRequired,urls:y.default.object.isRequired,username:y.default.string.isRequired,token:y.default.string.isRequired,addUpload:y.default.func.isRequired,updatePermissions:y.default.func.isRequired,permissions:y.default.object.isRequired,removeUploadedFile:y.default.func.isRequired};var O=(0,b.connect)(function(e){return{username:e.username,token:e.token,urls:e.urls,permissions:e.permissions}},function(e){return{addUpload:function(t){return e((0,E.addUpload)(t))},updatePermissions:function(t,a,n){return e((0,v.updatePermissions)(t,a,n))}}})((0,_.withStyles)(function(e){return{}})(S));t.default=O},Eyef:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=R(a("QbLZ")),r=R(a("Yz+Y")),l=R(a("iCc5")),u=R(a("V7oC")),o=R(a("FYw3")),i=R(a("mRg0")),s=R(a("YEIV")),d=a("vu7d"),c=R(a("1OZW")),f=R(a("1iKp")),p=R(a("aoIh")),m=R(a("VtDg")),h=R(a("7Nn7")),g=R(a("84s+")),y=R(a("17x9")),E=R(a("q1tI")),b=R(a("NeRm")),v=R(a("nzuV")),_=R(a("1TCx")),L=R(a("8+ys")),S=R(a("QUaF")),O=R(a("6ZaM")),P=a("/MKj"),M=a("tF6y"),x=a("SUMQ");function R(e){return e&&e.__esModule?e:{default:e}}var w=(0,x.withStyles)(function(e){return{head:{backgroundColor:e.palette.primary.dark,color:e.palette.common.white},body:{fontSize:14}}})(_.default),T=function(e){function t(e){(0,l.default)(this,t);var a=(0,o.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e));a.handleDeleted=function(e){var t=a.props,n=t.urls,r=t.deleteOldUpload,l=""+n.uploadsURL+e.id+"/";a.requests.doDelete(l).then(function(t){r(e.id)})};var n=a.props,u=n.token,i=n.username,s=u.split(" for ")[0];return a.requests=new d.ApiRequests(i,s),a}return(0,i.default)(t,e),(0,u.default)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.classes,r=t.upload,l=t.permissions,u=t.setCurrentLayerOpenPublishModal,o=t.setCurrentLayerOpenUpdateModal;return E.default.createElement(p.default,{defaultExpanded:!0},E.default.createElement(g.default,{classes:{content:a.panelSummary},expandIcon:E.default.createElement(f.default,null)},E.default.createElement(O.default,{className:a.flexGrow,noWrap:!0,variant:"subheading"},r.package.split("/").pop()),E.default.createElement(O.default,{className:a.flexGrow,noWrap:!0,variant:"subheading"},"Uploaded At: "+new Date(r.uploaded_at).toLocaleString()),E.default.createElement("div",null,E.default.createElement(O.default,{className:a.flexGrow,noWrap:!0,variant:"subheading"},"Owner: "+r.user.username))),E.default.createElement(h.default,null,E.default.createElement("div",{className:a.tableWrapper},E.default.createElement(b.default,{className:a.table},E.default.createElement(L.default,null,E.default.createElement(S.default,null,E.default.createElement(w,{className:a.textCenter},"Layer Name"),E.default.createElement(w,{className:a.textCenter},"Layer Type"),E.default.createElement(w,{className:a.textCenter},"Feature Count"),E.default.createElement(w,{className:a.textCenter},"Actions"))),E.default.createElement(v.default,null,r.layers.map(function(e,t){return E.default.createElement(S.default,{className:a.row,key:t},E.default.createElement(_.default,{className:a.textCenter,component:"th",scope:"row"},E.default.createElement(O.default,{noWrap:!0,variat:"body2"},e.name)),E.default.createElement(_.default,{className:a.textCenter,component:"th",scope:"row"},E.default.createElement(O.default,{noWrap:!0,variat:"body2"},e.geometry_type_name)),E.default.createElement(_.default,{className:a.textCenter,component:"th",scope:"row"},E.default.createElement(O.default,{noWrap:!0,variat:"body2"},e.feature_count)),E.default.createElement(_.default,{className:a.textCenter,component:"th",scope:"row"},(0,d.checkPermission)(l,"publish_from_package",r.id)&&E.default.createElement(c.default,{onClick:function(){return u(e)},variant:"contained",color:"primary",className:a.button},"Publish New"),(0,d.checkPermission)(l,"publish_from_package",r.id)&&E.default.createElement(c.default,{variant:"contained",onClick:function(){return o((0,n.default)({},e,{upload_id:r.id}))},color:"secondary",className:a.button},"Update Existing")))}))))),E.default.createElement(m.default,null,(0,d.checkPermission)(l,"download_package",r.id)&&E.default.createElement(c.default,{component:"a",href:r.download_url,size:"small",variant:"outlined",color:"primary",className:a.button},"Download"),(0,d.checkPermission)(l,"delete_package",r.id)&&E.default.createElement(c.default,{onClick:function(){return e.handleDeleted(r)},size:"small",variant:"outlined",color:"secondary",className:a.button},"Delete")))}}]),t}(E.default.Component);T.propTypes={classes:y.default.object.isRequired,deleteOldUpload:y.default.func.isRequired,setCurrentLayerOpenPublishModal:y.default.func.isRequired,setCurrentLayerOpenUpdateModal:y.default.func.isRequired,upload:y.default.object.isRequired,permissions:y.default.object.isRequired,token:y.default.string.isRequired,urls:y.default.object.isRequired,username:y.default.string.isRequired};t.default=(0,P.connect)(function(e){return{username:e.username,token:e.token,urls:e.urls,permissions:e.permissions}},function(e){return{deleteOldUpload:function(t){return e((0,M.deleteUpload)(t))}}})((0,x.withStyles)(function(e){var t;return{root:{width:"100%",marginTop:2*e.spacing.unit,marginBottom:2*e.spacing.unit},textCenter:{textAlign:"center"},title:{margin:e.spacing.unit,textAlign:"center"},button:{margin:e.spacing.unit},flexGrow:{flexGrow:1},panelSummary:(t={display:"flex"},(0,s.default)(t,e.breakpoints.down("sm"),{flexDirection:"column",padding:e.spacing.unit}),(0,s.default)(t,"overflow","hidden"),(0,s.default)(t,"alignItems","center"),t),table:{width:"100%"},tableWrapper:{overflowX:"auto",width:"100%"},row:{"&:nth-of-type(odd)":{backgroundColor:e.palette.background.default}},progress:{margin:2*e.spacing.unit}}})(T))},NDqc:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.username=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments[1];switch(t.type){case n.SET_USERNAME:return t.payload;default:return e}},t.urls=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];switch(t.type){case n.SET_URLS:return t.payload;default:return e}},t.token=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments[1];switch(t.type){case n.SET_TOKEN:return t.payload;default:return e}};var n=a("TUL1")},Nlzp:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(a("iCc5")),r=o(a("V7oC")),l=a("vu7d"),u=a("X7BR");function o(e){return e&&e.__esModule?e:{default:e}}var i=function(){function e(t,a,r){(0,n.default)(this,e);var u=a.split(" for ")[0];this.requests=new l.ApiRequests(t,u),this.urls=r}return(0,r.default)(e,[{key:"getUploads",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u.LIMIT;return this.requests.doGet(this.urls.uploadsURL+"?offset="+e+"&limit="+t)}},{key:"getPermissions",value:function(){return this.requests.doGet(this.urls.permissionsURL)}}]),e}();t.default=i},Q2AE:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.store=void 0,t.storeWithInitial=function(e){return(0,n.configureStore)(e)};var n=a("cXEB");t.store=(0,n.configureStore)()},"R9/I":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(a("QbLZ")),r=u(a("m1cH"));t.permissions=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1];switch(t.type){case l.SET_PERMISSIONS:return t.payload;case l.UPDATE_PERMISSIONS:return(0,n.default)({},e,function(e,t){var a={};return t.keys.map(function(u){var o=e[u],i=[];switch(t.operation){case l.DELETE_PERMISSION_OP:i=o.ids.filter(function(e){return e!=t.id});break;case l.ADD_PERMISSION_OP:i=[].concat((0,r.default)(o.ids),[t.id]);break;default:throw Error("Invalid Operation on Permission Obj")}o=(0,n.default)({},o,{ids:i}),a[u]=o}),(0,n.default)({},e,a)}(e,t.payload));default:return e}},t.permissionsLoading=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments[1];switch(t.type){case l.PERMISSIONS_LOADING:return t.payload;default:return e}};var l=a("TUL1");function u(e){return e&&e.__esModule?e:{default:e}}},RQfP:function(e,t){},RlU5:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(a("m1cH"));t.uploads=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1];switch(t.type){case r.ADD_UPLOAD:return[t.payload].concat((0,n.default)(e));case r.ADD_UPLOADS:return[].concat((0,n.default)(e),(0,n.default)(t.payload));case r.DELETE_UPLOAD:return e.filter(function(e){return e.id!=t.payload});case r.DELETE_UPLOADS:return e.map(function(e){return!t.payload.includes(e.id)});case r.SET_UPLOADS:return t.payload;default:return e}},t.uploadsLoading=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments[1];switch(t.type){case r.UPLOADS_LOADING:return t.payload;default:return e}},t.uploadsTotalCount=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments[1];switch(t.type){case r.SET_TOTAL_COUNT:return t.payload;default:return e}};var r=a("TUL1")},TUL1:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ADD_UPLOAD="ADD_UPLOAD",t.ADD_UPLOADS="ADD_UPLOADS",t.DELETE_UPLOAD="DELETE_UPLOAD",t.DELETE_UPLOADS="DELETE_UPLOADS",t.SET_UPLOADS="NEW_UPLOADS",t.UPLOADS_LOADING="UPLOADS_LOADING",t.SET_PERMISSIONS="SET_PERMISSIONS",t.UPDATE_PERMISSIONS="UPDATE_PERMISSIONS",t.PERMISSIONS_LOADING="PERMISSIONS_LOADING",t.SET_TOTAL_COUNT="SET_TOTAL_COUNT",t.SET_URLS="SET_URLS",t.SET_USERNAME="SET_USERNAME",t.SET_TOKEN="SET_TOKEN",t.ADD_PERMISSION_OP="ADD",t.DELETE_PERMISSION_OP="DELETE"},X7BR:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LIMIT=20},YUIr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=w(a("Yz+Y")),r=w(a("iCc5")),l=w(a("V7oC")),u=w(a("FYw3")),o=w(a("mRg0")),i=a("vu7d"),s=w(a("1OZW")),d=w(a("DKSo")),c=w(a("0G56")),f=w(a("Sk/v")),p=w(a("SNP2")),m=w(a("/xgX")),h=w(a("C+zi")),g=w(a("1DzM")),y=w(a("1IiC")),E=w(a("MwB+")),b=w(a("cUz1")),v=w(a("ctcd")),_=w(a("swsI")),L=w(a("17x9")),S=w(a("q1tI")),O=w(a("bSwy")),P=w(a("6ZaM")),M=w(a("TSYQ")),x=a("/MKj"),R=a("SUMQ");function w(e){return e&&e.__esModule?e:{default:e}}var T=function(e){function t(e){(0,r.default)(this,t);var a=(0,u.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));a.handleLayerTitleChange=function(e){a.setState({layerTitle:e.target.value})},a.handleSearch=function(){var e=a.state.layerTitle,t=a.props.urls.layersURL+"?title__icontains="+e+"&alternate__icontains="+e+"&permission=change_resourcebase";a.setState({layersLoading:!0},function(){a.requests.doGet(t).then(function(e){a.setState({layers:e.objects,layersLoading:!1})})})},a.state={layerTitle:"",layers:[],layersLoading:!1};var l=a.props,o=l.token,s=l.username,d=o.split(" for ")[0];return a.requests=new i.ApiRequests(s,d),a}return(0,o.default)(t,e),(0,l.default)(t,[{key:"render",value:function(){var e=this.state,t=e.layers,a=e.layersLoading,n=this.props,r=n.currentLayer,l=n.updateExistingModalOpen,u=n.handleUpdateExistingModal,o=n.updateExistingLoading,i=n.classes,L=n.updateError;return S.default.createElement(c.default,{fullScreen:!0,disableBackdropClick:!0,open:l,onClose:u,"aria-labelledby":"form-dialog-title"},S.default.createElement(h.default,{disableTypography:!0,className:i.dialogTitle}," ",S.default.createElement(P.default,{className:(0,M.default)(i.flexGrow,i.whiteText),noWrap:!0,variant:"title"},"Update/Replace Layer")),S.default.createElement(p.default,null,S.default.createElement(m.default,null,L&&S.default.createElement(P.default,{className:i.flexGrow,noWrap:!0,color:"secondary",variant:"subheading"},L),"Search For The Layer You Want To Replace/Update By "+(r?r.name:"")),S.default.createElement(g.default,{className:(0,M.default)(i.margin,i.textField,i.fullWidth)},S.default.createElement(v.default,{htmlFor:"layers-search"},"Layer Name/Layer Title"),S.default.createElement(E.default,{id:"layers-search",type:"text",value:this.state.layerTitle,onChange:this.handleLayerTitleChange,endAdornment:S.default.createElement(b.default,{position:"end"},S.default.createElement(y.default,{"aria-label":"Search",onClick:this.handleSearch},S.default.createElement(O.default,null))),require:"true",fullWidth:!0})),!a&&t.length>0&&t.map(function(e){return S.default.createElement(_.default,{key:e.id,currentLayer:r,layer:e})})),S.default.createElement(f.default,null,(o||a)&&S.default.createElement(d.default,{className:i.progress,thickness:7}),S.default.createElement(s.default,{disabled:o||a,onClick:u,color:"primary"},"Cancel")))}}]),t}(S.default.Component);T.propTypes={classes:L.default.object.isRequired,currentLayer:L.default.object,token:L.default.string.isRequired,urls:L.default.object.isRequired,username:L.default.string.isRequired,handleUpdateExistingModal:L.default.func.isRequired,updateExistingModalOpen:L.default.bool.isRequired,updateExistingLoading:L.default.bool.isRequired,updateError:L.default.string};t.default=(0,x.connect)(function(e){return{username:e.username,token:e.token,urls:e.urls}},function(e){return{}})((0,R.withStyles)(function(e){return{flexGrow:{flexGrow:1},button:{margin:e.spacing.unit},margin:{margin:e.spacing.unit},textField:{flexBasis:200},progress:{margin:2*e.spacing.unit},fullWidth:{width:"100%"},layerItem:{margin:2*e.spacing.unit,display:"flex",alignItems:"center",justifyContent:"space-between"},dialogTitle:{backgroundColor:e.palette.primary[500],marginBottom:2*e.spacing.unit},whiteText:{color:e.palette.common.white}}})(T))},cXEB:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.configureStore=function(e){return(0,n.createStore)(r.default,e,(0,n.applyMiddleware)(l.default))};var n=a("ANjH"),r=u(a("cokx")),l=u(a("sINF"));function u(e){return e&&e.__esModule?e:{default:e}}},cokx:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("R9/I"),r=a("NDqc"),l=a("RlU5"),u=a("ANjH");t.default=(0,u.combineReducers)({uploads:l.uploads,uploadsLoading:l.uploadsLoading,permissions:n.permissions,permissionsLoading:n.permissionsLoading,uploadsTotalCount:l.uploadsTotalCount,urls:r.urls,username:r.username,token:r.token})},ixGs:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=E(a("Yz+Y")),r=E(a("iCc5")),l=E(a("V7oC")),u=E(a("FYw3")),o=E(a("mRg0")),i=a("vu7d"),s=E(a("EHL7")),d=(E(a("pPbJ")),E(a("17x9"))),c=E(a("7cd4")),f=E(a("q1tI")),p=E(a("6ZaM")),m=E(a("YUIr")),h=E(a("Eyef")),g=a("/MKj"),y=a("SUMQ");function E(e){return e&&e.__esModule?e:{default:e}}var b=function(e){function t(e){(0,r.default)(this,t);var a=(0,u.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));a.setCurrentLayerOpenPublishModal=function(e){a.setState({currentLayer:e,publishName:e.expected_name},a.handlPublishModal)},a.setCurrentLayerOpenUpdateModal=function(e){a.setState({currentLayer:e},a.handleUpdateExistingModal)},a.handlPublishModal=function(){var e=a.state.publishModalOpen;a.setState({publishModalOpen:!e,publishError:null})},a.handleUpdateExistingModal=function(){var e=a.state.updateExistingModalOpen;a.setState({updateExistingModalOpen:!e,updateError:null})},a.handlePublishName=function(e){a.setState({publishName:(0,i.convertToSlug)(e.target.value)})},a.replaceLayer=function(){},a.publishLayer=function(){var e=a.state,t=e.currentLayer,n=e.publishName;a.setState({publishLoading:!0},function(){a.requests.doGet(t.urls.publish_url+"?publish_name="+n).then(function(e){if(!e.layer_url)throw Error(e.error_message);window.location.href=e.layer_url}).catch(function(e){a.setState({publishLoading:!1,publishError:e.message})})})},a.state={publishModalOpen:!1,publishName:null,currentLayer:null,publishLoading:!1,publishError:null,updateError:null,updateExistingLoading:!1,updateExistingModalOpen:!1};var l=a.props,o=l.token,s=l.username,d=o.split(" for ")[0];return a.requests=new i.ApiRequests(s,d),a}return(0,o.default)(t,e),(0,l.default)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.classes,n=t.uploads,r=this.state,l=r.publishModalOpen,u=r.publishLoading,o=r.publishError,i=r.publishName,d=r.updateExistingLoading,g=r.updateError,y=r.updateExistingModalOpen,E=r.currentLayer;return f.default.createElement("div",{className:a.root},f.default.createElement(c.default,{handlePublishName:this.handlePublishName,publishLoading:u,publishError:o,publishName:i,handlPublishModal:this.handlPublishModal,publishLayer:this.publishLayer,publishModalOpen:l}),f.default.createElement(m.default,{currentLayer:E,updateExistingLoading:d,updateError:g,handleUpdateExistingModal:this.handleUpdateExistingModal,replaceLayer:this.replaceLayer,updateExistingModalOpen:y}),f.default.createElement(s.default,null),f.default.createElement(p.default,{noWrap:!0,color:"default",className:a.title,variant:"headline"},"Uploaded List"),n&&n.map(function(t,a){return f.default.createElement(h.default,{setCurrentLayerOpenUpdateModal:e.setCurrentLayerOpenUpdateModal,upload:t,setCurrentLayerOpenPublishModal:e.setCurrentLayerOpenPublishModal,key:a})}))}}]),t}(f.default.Component);b.propTypes={classes:d.default.object.isRequired,uploads:d.default.array.isRequired,token:d.default.string.isRequired,urls:d.default.object.isRequired,username:d.default.string.isRequired};t.default=(0,g.connect)(function(e){return{username:e.username,token:e.token,urls:e.urls,uploads:e.uploads}},function(e){return{}})((0,y.withStyles)(function(e){return{root:{width:"100%",marginTop:2*e.spacing.unit,marginBottom:2*e.spacing.unit,boxSizing:"border-box",padding:e.spacing.unit},textCenter:{textAlign:"center"},title:{margin:e.spacing.unit,textAlign:"center"},button:{margin:e.spacing.unit},flexGrow:{flexGrow:1},panelSummary:{display:"flex",alignItems:"center"},table:{width:"100%"},tableWrapper:{overflowX:"auto",width:"100%"},row:{"&:nth-of-type(odd)":{backgroundColor:e.palette.background.default}},progress:{margin:2*e.spacing.unit}}})(b))},swsI:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=P(a("Yz+Y")),r=P(a("iCc5")),l=P(a("V7oC")),u=P(a("FYw3")),o=P(a("mRg0")),i=P(a("YEIV")),s=a("vu7d"),d=P(a("1OZW")),c=P(a("DKSo")),f=P(a("ciEP")),p=P(a("JgXy")),m=P(a("NABS")),h=P(a("4eE1")),g=P(a("WqRt")),y=P(a("pPbJ")),E=P(a("17x9")),b=P(a("q1tI")),v=P(a("nwgO")),_=P(a("6ZaM")),L=P(a("TSYQ")),S=a("/MKj"),O=a("SUMQ");function P(e){return e&&e.__esModule?e:{default:e}}var M=function(e){function t(e){(0,r.default)(this,t);var a=(0,u.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));a.loadSchema=function(){var e=a.props,t=e.urls,n=e.layer,r=e.currentLayer,l=t.compareLayerURL(r.upload_id,r.name,n.alternate);a.requests.doGet(l).then(function(e){e.error_message?a.setState({schemaLoading:!1,schema:null},alert(e.error_message)):a.setState({schema:e,schemaLoading:!1,expand:!0})}).catch(function(e){this.setState({schemaLoading:!1,schema:null},alert(e.message))}.bind(a))},a.compareSchema=function(){var e=a.state,t=e.schema,n=e.expand;t?a.setState({expand:!n}):a.setState({schemaLoading:!0,expand:!1},a.loadSchema)},a.reloadLayer=function(){var e=a.props,t=e.urls,n=e.layer,r=e.currentLayer,l=t.reloadURL(r.upload_id,r.name,n.alternate);a.requests.doGet(l).then(function(e){e.error_message?a.setState({reloadLayerLoading:!1},alert(e.error_message)):a.setState({reloadLayerLoading:!1},function(){return alert(e.status)})}).catch(function(e){this.setState({reloadLayerLoading:!1},alert(e.message))}.bind(a))},a.startReloadLayer=function(){a.setState({reloadLayerLoading:!0},a.reloadLayer)},a.replaceLayer=function(){var e=a.props,t=e.layer,n=e.currentLayer.urls.publish_url+"?replace=true&publish_name="+t.alternate.split(":").pop();a.requests.doGet(n).then(function(e){e.error_message?a.setState({replaceLayerLoading:!1},alert(e.error_message)):a.setState({replaceLayerLoading:!1},function(){return window.location.href=e.layer_url})}).catch(function(e){this.setState({replaceLayerLoading:!1},alert(e.message))}.bind(a))},a.startReplaceLayer=function(){a.setState({replaceLayerLoading:!0},a.replaceLayer)},a.state={schema:null,schemaLoading:null,reloadLayerLoading:!1,replaceLayerLoading:!1,expand:!1};var l=a.props,o=l.token,i=l.username,d=o.split(" for ")[0];return a.requests=new s.ApiRequests(i,d),a}return(0,o.default)(t,e),(0,l.default)(t,[{key:"render",value:function(){var e=this.props,t=e.layer,a=e.classes,n=this.state,r=n.schema,l=n.schemaLoading,u=n.expand,o=n.reloadLayerLoading,i=n.replaceLayerLoading;return b.default.createElement(y.default,{key:t.id,className:a.layerItem,elevation:2},b.default.createElement("div",{className:a.layerItemActions},b.default.createElement(_.default,{noWrap:!0,className:(0,L.default)(a.flexGrow,a.button),variant:"subheading"},t.title),l&&b.default.createElement(c.default,{className:a.progress,thickness:5}),o&&b.default.createElement(c.default,{color:"default",className:a.progress,thickness:5}),i&&b.default.createElement(c.default,{color:"secondary",className:a.progress,thickness:5}),b.default.createElement(v.default,{title:"Comapare The Schema of this Layer With the Target Layer and return the result"},b.default.createElement(d.default,{onClick:this.compareSchema,variant:"outlined",color:"primary",className:a.button},"Compare Schema")),b.default.createElement(v.default,{title:"Completly Replace Layer i.e(replace Layer Portal Record, Styles, Database Table, Geoserver Layer and thumbnails)"},b.default.createElement(d.default,{onClick:this.startReplaceLayer,variant:"outlined",color:"secondary",className:a.button},"Replace")),b.default.createElement(v.default,{title:"Replace Current Database Table With This One"},b.default.createElement(d.default,{onClick:this.startReloadLayer,variant:"outlined",color:"default",className:a.button},"Update(DB Table Replacement)"))),b.default.createElement(f.default,{in:u,timeout:"auto",unmountOnExit:!0},b.default.createElement("div",{className:a.content},b.default.createElement("div",{className:a.textCenter},!l&&r&&b.default.createElement(_.default,{color:r.compatible?"primary":"secondary",noWrap:!0,className:(0,L.default)(a.flexGrow,a.button),variant:"title"},"Layer is "+(r.compatible?"Compatible":"Incompatible"))),b.default.createElement("div",{className:a.schemaFields},!l&&r&&r.new_fields.length>0&&b.default.createElement(p.default,{component:"nav",subheader:b.default.createElement(g.default,{component:"div"},"New Fields")},r.new_fields.map(function(e,t){return b.default.createElement(m.default,{key:t},b.default.createElement(h.default,{inset:!0,primary:"Field: "+e[0],secondary:"Type: "+e[1]}))})),!l&&r&&r.deleted_fields.length>0&&b.default.createElement(p.default,{component:"nav",subheader:b.default.createElement(g.default,{component:"div"},"Deleted Fields")},r.deleted_fields.map(function(e,t){return b.default.createElement(m.default,{key:t},b.default.createElement(h.default,{inset:!0,primary:"Field: "+e[0],secondary:"Type: "+e[1]}))}))))))}}]),t}(b.default.Component);M.propTypes={classes:E.default.object.isRequired,token:E.default.string.isRequired,urls:E.default.object.isRequired,username:E.default.string.isRequired,layer:E.default.object.isRequired,currentLayer:E.default.object.isRequired};t.default=(0,S.connect)(function(e){return{username:e.username,token:e.token,urls:e.urls}},function(e){return{}})((0,O.withStyles)(function(e){var t;return{flexGrow:{flexGrow:1},button:{margin:e.spacing.unit},progress:{margin:2*e.spacing.unit},layerItem:{margin:2*e.spacing.unit,display:"flex",flexDirection:"column"},layerItemActions:(t={display:"flex"},(0,i.default)(t,e.breakpoints.down("sm"),{flexDirection:"column"}),(0,i.default)(t,"alignItems","center"),(0,i.default)(t,"justifyContent","space-between"),t),content:{padding:e.spacing.unit},schemaFields:{display:"flex",justifyContent:"space-around"},textCenter:{textAlign:"center"}}})(M))},tF6y:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addUpload=function(e){return{type:n.ADD_UPLOAD,payload:e}},t.addUploads=function(e){return{type:n.ADD_UPLOADS,payload:e}},t.deleteUpload=function(e){return{type:n.DELETE_UPLOAD,payload:e}},t.deleteUploads=function(e){return{type:n.DELETE_UPLOADS,payload:e}},t.newUploads=function(e){return{type:n.SET_UPLOADS,payload:e}},t.uploadsLoading=function(e){return{type:n.UPLOADS_LOADING,payload:e}},t.uploadsTotalCount=function(e){return{type:n.SET_TOTAL_COUNT,payload:e}};var n=a("TUL1")},uctU:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a("1LhQ");var n=s(a("YDiY")),r=(s(a("1IiC")),s(a("uniG")),s(a("17x9"))),l=s(a("q1tI")),u=s(a("2VVu")),o=s(a("6ZaM")),i=a("SUMQ");function s(e){return e&&e.__esModule?e:{default:e}}function d(e){var t=e.classes,a=e.title;return l.default.createElement("div",{className:t.root},l.default.createElement(n.default,{position:"static"},l.default.createElement(u.default,null,l.default.createElement(o.default,{variant:"title",color:"inherit",className:t.flex},a))))}d.propTypes={classes:r.default.object.isRequired,title:r.default.string.isRequired},t.default=(0,i.withStyles)({root:{flexGrow:1},flex:{flexGrow:1}})(d)},vu7d:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ApiRequests=void 0;var n=u(a("QbLZ")),r=u(a("iCc5")),l=u(a("V7oC"));function u(e){return e&&e.__esModule?e:{default:e}}function o(e){if(e.lengthComputable){var t=e.loaded/e.total*100;console.log("Progress is ----\x3e "+t)}}function i(e){console.log("The transfer is complete.")}function s(e){console.error("An error occurred while transferring the file.")}t.convertToSlug=function(e){return e.toLowerCase().replace(/ /g,"_").replace(/[^\w-]+/g,"")},t.checkPermission=function(e,t,a){if(e[t].ids.indexOf(a)>-1)return!0;return!1};t.ApiRequests=function(){function e(t,a){(0,r.default)(this,e),this.token=a,this.username=t}return(0,l.default)(e,[{key:"doPost",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return fetch(e,{method:"POST",credentials:"include",headers:new Headers((0,n.default)({Authorization:"ApiKey "+this.username+":"+this.token},a)),body:t}).then(function(e){return e.json()})}},{key:"doDelete",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return fetch(e,{method:"DELETE",credentials:"include",headers:(0,n.default)({Authorization:"ApiKey "+this.username+":"+this.token},t)}).then(function(e){return e.text()})}},{key:"doGet",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return fetch(e,{method:"GET",credentials:"include",headers:(0,n.default)({Authorization:"ApiKey "+this.username+":"+this.token},t)}).then(function(e){return e.json()})}},{key:"uploadWithProgress",value:function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:o,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:i,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:s,u=new XMLHttpRequest;u.upload.addEventListener("progress",function(e){n(e)},!1),u.addEventListener("load",function(e){r(u)}),u.addEventListener("error",function(){l(u)}),u.onreadystatechange=function(){u.readyState==XMLHttpRequest.DONE&&a(u.responseText)},u.open("POST",e,!0),u.setRequestHeader("Cache-Control","no-cache"),u.setRequestHeader("Authorization","ApiKey "+this.username+":"+this.token),u.send(t)}}]),e}()}})});
//# sourceMappingURL=/static/gpkg_manager/dist/sourcemaps/../GeopackageManager.bundle.js.map
//# sourceMappingURL=GeopackageManager.bundle.js.map